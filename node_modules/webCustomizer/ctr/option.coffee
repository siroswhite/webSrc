#==============================================================================
# require
#==============================================================================
core = require("core")
event_trans = require("event/trans")
data = require("../data")

#==============================================================================
# interface
#==============================================================================
exports.init = () ->
  initUIVal()
  initSlider()
  initEventTrans()
  
#============================================================================
# event
#============================================================================
initEventTrans = () ->
  #----------------------------------------------------------------------------
  # transSelect
  #----------------------------------------------------------------------------
  $(".transSetter select").change (e) =>
    data.optionData.trans.method = $(e.currentTarget).val()
    setTransOption()
    
  #------------------------------------------------------------------------------
  # changeRange
  #------------------------------------------------------------------------------
  $(".transRange").bind 'slide', (e, ui) =>
    if ui != undefined
      $("#" + $(e.currentTarget).attr('id') + "Input").val(ui.value)
      data.optionData.trans.time = ui.value
    setTransOption()
    
  #------------------------------------------------------------------------------
  # changeText
  #------------------------------------------------------------------------------
  $('.transRangeText').bind 'change', (e) =>
    data.optionData.trans.time = $(e.currentTarget).val()
    $("#" + $(e.currentTarget).attr("id").split("Input")[0]).slider(value: $(e.currentTarget).val())
    setTransOption()
    
#==============================================================================
# setOption
#==============================================================================
#------------------------------------------------------------------------------
# setTrans
#------------------------------------------------------------------------------
setTransOption = () ->
  event_trans.option.method = data.optionData.trans.method
  event_trans.option.time = data.optionData.trans.time
  
#==============================================================================
# initUIVal
#==============================================================================
initUIVal = () ->
  initTrans = () ->
    $("#method_trans_select").val(data.optionData.trans.method)
    $("#time_trans_range" ).slider(value: data.optionData.trans.time)
    $("#time_trans_rangeInput" ).val(data.optionData.trans.time)
    setTransOption()
  initTrans()

#==============================================================================
# slider
#==============================================================================
initSlider = () ->
  #------------------------------------------------------------------------------
  # trans
  #------------------------------------------------------------------------------
  $(".transRange").slider(
    max: 3000
    min: 0
  )

#==============================================================================
# generate
#==============================================================================
exports.generateCode = () ->
  str = "event_trans.option.method = \"" + data.optionData.trans.method + "\"\n"
  str = str + "event_trans.option.time = " + data.optionData.trans.time + "\n"
  str